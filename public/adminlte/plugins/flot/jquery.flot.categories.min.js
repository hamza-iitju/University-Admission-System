(function($){var options={xaxis:{courses:null},yaxis:{courses:null}};function processRawData(plot,series,data,datapoints){var xCourses=series.xaxis.options.mode=="courses",yCourses=series.yaxis.options.mode=="courses";if(!(xCourses||yCourses))return;var format=datapoints.format;if(!format){var s=series;format=[];format.push({x:true,number:true,required:true});format.push({y:true,number:true,required:true});if(s.bars.show||s.lines.show&&s.lines.fill){var autoscale=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);format.push({y:true,number:true,required:false,defaultValue:0,autoscale:autoscale});if(s.bars.horizontal){delete format[format.length-1].y;format[format.length-1].x=true}}datapoints.format=format}for(var m=0;m<format.length;++m){if(format[m].x&&xCourses)format[m].number=false;if(format[m].y&&yCourses)format[m].number=false}}function getNextIndex(courses){var index=-1;for(var v in courses)if(courses[v]>index)index=courses[v];return index+1}function coursesTickGenerator(axis){var res=[];for(var label in axis.courses){var v=axis.courses[label];if(v>=axis.min&&v<=axis.max)res.push([v,label])}res.sort(function(a,b){return a[0]-b[0]});return res}function setupCoursesForAxis(series,axis,datapoints){if(series[axis].options.mode!="courses")return;if(!series[axis].courses){var c={},o=series[axis].options.courses||{};if($.isArray(o)){for(var i=0;i<o.length;++i)c[o[i]]=i}else{for(var v in o)c[v]=o[v]}series[axis].courses=c}if(!series[axis].options.ticks)series[axis].options.ticks=coursesTickGenerator;transformPointsOnAxis(datapoints,axis,series[axis].courses)}function transformPointsOnAxis(datapoints,axis,courses){var points=datapoints.points,ps=datapoints.pointsize,format=datapoints.format,formatColumn=axis.charAt(0),index=getNextIndex(courses);for(var i=0;i<points.length;i+=ps){if(points[i]==null)continue;for(var m=0;m<ps;++m){var val=points[i+m];if(val==null||!format[m][formatColumn])continue;if(!(val in courses)){courses[val]=index;++index}points[i+m]=courses[val]}}}function processDatapoints(plot,series,datapoints){setupCoursesForAxis(series,"xaxis",datapoints);setupCoursesForAxis(series,"yaxis",datapoints)}function init(plot){plot.hooks.processRawData.push(processRawData);plot.hooks.processDatapoints.push(processDatapoints)}$.plot.plugins.push({init:init,options:options,name:"courses",version:"1.0"})})(jQuery);